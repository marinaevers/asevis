{"version":3,"sources":["webpack:///./src/lib/components/d3BrushableHeatmap.js"],"names":["d3Heatmap","calculateSizes","a","cellSize","left","right","i","length","create","el","props","margin","top","bottom","width","height","svg","d3","append","attr","cols","data","columns","sort","rows","scaleX","domain","range","axX","call","xLabel","text","scaleY","axY","yLabel","tooltip","style","mouseover","d","mousemove","object","html","x","y","value","pageX","pageY","mouseclick","target","mouseleave","min","values","max","forEach","e","colorScale","cellSizeX","cellSizeY","unitSizeX","unitSizeY","cells","selectAll","enter","on","update","wrappedClick","onClick","console","log","destroy"],"mappings":";;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AAEA,IAAIA,SAAS,GAAG,EAAhB;;AAEA,IAAMC,cAAc,GAAG,SAAjBA,cAAiB,CAACC,CAAD,EAAO;AAC1B,MAAIC,QAAQ,GAAG,EAAf;AACAA,UAAQ,CAACD,CAAC,CAAC,CAAD,CAAF,CAAR,GAAiB;AACbE,QAAI,EAAG,CADM;AAEbC,SAAK,EAAE,OAAKH,CAAC,CAAC,CAAD,CAAD,GAAKA,CAAC,CAAC,CAAD,CAAX;AAFM,GAAjB;;AAIA,OAAK,IAAII,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAACJ,CAAC,CAACK,MAAF,GAAS,CAA3B,EAA8BD,CAAC,EAA/B,EAAmC;AAC/BH,YAAQ,CAACD,CAAC,CAACI,CAAD,CAAF,CAAR,GAAiB;AACbF,UAAI,EAAG,OAAKF,CAAC,CAACI,CAAD,CAAD,GAAKJ,CAAC,CAACI,CAAC,GAAC,CAAH,CAAX,CADM;AAEbD,WAAK,EAAE,OAAKH,CAAC,CAACI,CAAC,GAAC,CAAH,CAAD,GAAOJ,CAAC,CAACI,CAAD,CAAb;AAFM,KAAjB;AAIH;;AACDH,UAAQ,CAACD,CAAC,CAACA,CAAC,CAACK,MAAF,GAAS,CAAV,CAAF,CAAR,GAA0B;AACtBH,QAAI,EAAG,OAAKF,CAAC,CAACA,CAAC,CAACK,MAAF,GAAS,CAAV,CAAD,GAAcL,CAAC,CAACA,CAAC,CAACK,MAAF,GAAS,CAAV,CAApB,CADe;AAEtBF,SAAK,EAAE;AAFe,GAA1B;AAIA,SAAOF,QAAP;AACH,CAjBD;;AAmBAH,SAAS,CAACQ,MAAV,GAAmB,UAACC,EAAD,EAAKC,KAAL,EAAe;AAC9B,MAAIC,MAAM,GAAG;AAACC,OAAG,EAAE,EAAN;AAAUP,SAAK,EAAE,EAAjB;AAAqBQ,UAAM,EAAE,EAA7B;AAAiCT,QAAI,EAAE;AAAvC,GAAb;AAAA,MACIU,KAAK,GAAG,MAAMH,MAAM,CAACP,IAAb,GAAoBO,MAAM,CAACN,KADvC;AAAA,MAEIU,MAAM,GAAG,MAAMJ,MAAM,CAACC,GAAb,GAAmBD,MAAM,CAACE,MAFvC;AAIA,MAAIG,GAAG,GAAGC,yCAAA,CAAUR,EAAV,EAAcS,MAAd,CAAqB,KAArB,EACLC,IADK,CACA,OADA,EACSL,KAAK,GAAGH,MAAM,CAACP,IAAf,GAAsBO,MAAM,CAACN,KADtC,EAELc,IAFK,CAEA,QAFA,EAEUJ,MAAM,GAAGJ,MAAM,CAACC,GAAhB,GAAsBD,MAAM,CAACE,MAFvC,EAGLK,MAHK,CAGE,GAHF,EAILC,IAJK,CAIA,WAJA,EAKF,eAAeR,MAAM,CAACP,IAAtB,GAA6B,GAA7B,GAAmCO,MAAM,CAACC,GAA1C,GAAgD,GAL9C,CAAV,CAL8B,CAY9B;;AACA,MAAIQ,IAAI,GAAGV,KAAK,CAACW,IAAN,CAAWC,OAAX,CAAmBC,IAAnB,CAAwBN,4CAAxB,CAAX;AACA,MAAIO,IAAI,GAAGd,KAAK,CAACW,IAAN,CAAWG,IAAX,CAAgBD,IAAhB,CAAqBN,4CAArB,CAAX;AACA,MAAIQ,MAAM,GAAGR,8CAAA,GACRS,MADQ,CACD,CAACN,IAAI,CAAC,CAAD,CAAL,EAAUA,IAAI,CAACA,IAAI,CAACb,MAAL,GAAY,CAAb,CAAd,CADC,EAERoB,KAFQ,CAEF,CAAC,CAAD,EAAIb,KAAJ,CAFE,CAAb;AAGA,MAAIc,GAAG,GAAGZ,GAAG,CAACE,MAAJ,CAAW,GAAX,EACLC,IADK,CACA,WADA,EACa,iBAAiBJ,MAAjB,GAA0B,GADvC,EAELc,IAFK,CAEAZ,6CAAA,CAAcQ,MAAd,CAFA,CAAV;;AAGA,MAAGf,KAAK,CAACoB,MAAT,EAAiB;AACbF,OAAG,CAACV,MAAJ,CAAW,MAAX,EACKC,IADL,CACU,GADV,EACe,MAAIL,KADnB,EAEKK,IAFL,CAEU,GAFV,EAEe,MAAIR,MAAM,CAACE,MAF1B,EAGKM,IAHL,CAGU,aAHV,EAGyB,QAHzB,EAIKA,IAJL,CAIU,QAJV,EAIoB,OAJpB,EAKKY,IALL,CAKUrB,KAAK,CAACoB,MALhB;AAMH;;AACD,MAAIE,MAAM,GAAGf,8CAAA,GACRS,MADQ,CACD,CAACF,IAAI,CAAC,CAAD,CAAL,EAAUA,IAAI,CAACA,IAAI,CAACjB,MAAL,GAAY,CAAb,CAAd,CADC,EAERoB,KAFQ,CAEF,CAACZ,MAAD,EAAS,CAAT,CAFE,CAAb;AAGA,MAAIkB,GAAG,GAAGjB,GAAG,CAACE,MAAJ,CAAW,GAAX,EAAgBW,IAAhB,CAAqBZ,2CAAA,CAAYe,MAAZ,CAArB,CAAV;;AACA,MAAGtB,KAAK,CAACwB,MAAT,EAAiB;AACbD,OAAG,CAACf,MAAJ,CAAW,MAAX,EACKC,IADL,CACU,WADV,EACuB,aADvB,EAEKA,IAFL,CAEU,GAFV,EAEe,CAAC,GAAD,GAAKJ,MAFpB,EAGKI,IAHL,CAGU,GAHV,EAGe,CAAC,GAAD,GAAKR,MAAM,CAACE,MAH3B,EAIKM,IAJL,CAIU,aAJV,EAIyB,QAJzB,EAKKA,IALL,CAKU,QALV,EAKoB,OALpB,EAMKY,IANL,CAMUrB,KAAK,CAACwB,MANhB;AAOH,GAzC6B,CA2C1B;;;AACJ,MAAIC,OAAO,GAAGlB,yCAAA,CAAUR,EAAV,EACTS,MADS,CACF,KADE,EAETkB,KAFS,CAEH,SAFG,EAEQ,CAFR,EAGTjB,IAHS,CAGJ,OAHI,EAGK,SAHL,EAITiB,KAJS,CAIH,kBAJG,EAIiB,OAJjB,EAKTA,KALS,CAKH,QALG,EAKO,OALP,EAMTA,KANS,CAMH,cANG,EAMa,KANb,EAOTA,KAPS,CAOH,eAPG,EAOc,KAPd,EAQTA,KARS,CAQH,SARG,EAQQ,KARR,EASTA,KATS,CASH,UATG,EASS,UATT,CAAd,CA5C8B,CAsD9B;;AACA,MAAIC,SAAS,GAAG,SAAZA,SAAY,CAASC,CAAT,EAAY;AACxBH,WAAO,CAACC,KAAR,CAAc,SAAd,EAAyB,CAAzB;AACH,GAFD;;AAGA,MAAIG,SAAS,GAAG,SAAZA,SAAY,CAASD,CAAT,EAAYE,MAAZ,EAAoB;AAChCL,WAAO,CACFM,IADL,CACUD,MAAM,CAACE,CAAP,GAAS,GAAT,GAAaF,MAAM,CAACG,CAApB,GAAsB,aAAtB,GAAsCH,MAAM,CAACI,KADvD,EAEKR,KAFL,CAEW,MAFX,EAEoBE,CAAC,CAACO,KAAF,GAAQ,EAAT,GAAe,IAFlC,EAGKT,KAHL,CAGW,KAHX,EAGmBE,CAAC,CAACQ,KAAF,GAAQ,EAAT,GAAe,IAHjC;AAIH,GALD;;AAMA,MAAIC,UAAU,GAAG,SAAbA,UAAa,CAAST,CAAT,EAAY;AACzBrB,6CAAA,CAAUqB,CAAC,CAACU,MAAZ,EACKZ,KADL,CACW,QADX,EACqB,KADrB;AAEH,GAHD;;AAIA,MAAIa,UAAU,GAAG,SAAbA,UAAa,CAASX,CAAT,EAAY;AACzBH,WAAO,CAACC,KAAR,CAAc,SAAd,EAAyB,CAAzB,EADyB,CAEzB;AACA;AACH,GAJD;;AAMA,MAAIc,GAAG,GAAGxC,KAAK,CAACW,IAAN,CAAW8B,MAAX,CAAkB,CAAlB,EAAqBP,KAA/B;AACA,MAAIQ,GAAG,GAAG1C,KAAK,CAACW,IAAN,CAAW8B,MAAX,CAAkB,CAAlB,EAAqBP,KAA/B;AACAlC,OAAK,CAACW,IAAN,CAAW8B,MAAX,CAAkBE,OAAlB,CAA0B,UAAAC,CAAC,EAAI;AAAC,QAAGA,CAAC,CAACV,KAAF,GAAUM,GAAb,EAAkB;AAC9CA,SAAG,GAAGI,CAAC,CAACV,KAAR;AACH;;AACD,QAAGU,CAAC,CAACV,KAAF,GAAUQ,GAAb,EAAkB;AACdA,SAAG,GAAGE,CAAC,CAACV,KAAR;AACH;AAAC,GALF,EA5E8B,CAmF9B;;AACA,MAAIW,UAAU,GAAGtC,8CAAA,CAAeA,qDAAf,EACZS,MADY,CACL,CAACwB,GAAD,EAAME,GAAN,CADK,EAEZzB,KAFY,CAEN,CAAC,SAAD,EAAY,SAAZ,CAFM,CAAjB,CApF8B,CAwF9B;;AACA,MAAI6B,SAAS,GAAGvD,cAAc,CAACmB,IAAD,CAA9B;AACA,MAAIqC,SAAS,GAAGxD,cAAc,CAACuB,IAAD,CAA9B;AACA,MAAIkC,SAAS,GAAG5C,KAAK,IAAEM,IAAI,CAACA,IAAI,CAACb,MAAL,GAAY,CAAb,CAAJ,GAAoBa,IAAI,CAAC,CAAD,CAA1B,CAArB;AACA,MAAIuC,SAAS,GAAG5C,MAAM,IAAES,IAAI,CAACA,IAAI,CAACjB,MAAL,GAAY,CAAb,CAAJ,GAAoBiB,IAAI,CAAC,CAAD,CAA1B,CAAtB;AACA,MAAIoC,KAAK,GAAG5C,GAAG,CAAC6C,SAAJ,CAAc,MAAd,EACPxC,IADO,CACFX,KAAK,CAACW,IAAN,CAAW8B,MADT,EAEPW,KAFO,GAEC5C,MAFD,CAEQ,GAFR,EAEaA,MAFb,CAEoB,MAFpB,EAGPC,IAHO,CAGF,OAHE,EAGO,MAHP,EAIPA,IAJO,CAIF,OAJE,EAIO,UAASmB,CAAT,EAAY;AAAC,WAAOoB,SAAS,IAAEF,SAAS,CAAClB,CAAC,CAACI,CAAH,CAAT,CAAetC,IAAf,GAAsBoD,SAAS,CAAClB,CAAC,CAACI,CAAH,CAAT,CAAerC,KAAvC,CAAhB;AAA8D,GAJlF,EAKPc,IALO,CAKF,QALE,EAKQ,UAASmB,CAAT,EAAY;AAAC,WAAOqB,SAAS,IAAEF,SAAS,CAACnB,CAAC,CAACK,CAAH,CAAT,CAAevC,IAAf,GAAsBqD,SAAS,CAACnB,CAAC,CAACK,CAAH,CAAT,CAAetC,KAAvC,CAAhB;AAA8D,GALnF,EAMPc,IANO,CAMF,GANE,EAMG,UAASmB,CAAT,EAAY;AAAC,WAAON,MAAM,CAACM,CAAC,CAACK,CAAF,GAAIc,SAAS,CAACnB,CAAC,CAACK,CAAH,CAAT,CAAetC,KAApB,CAAb;AAAwC,GANxD,EAOPc,IAPO,CAOF,GAPE,EAOG,UAASmB,CAAT,EAAY;AAAC,WAAOb,MAAM,CAACa,CAAC,CAACI,CAAF,GAAIc,SAAS,CAAClB,CAAC,CAACI,CAAH,CAAT,CAAetC,IAApB,CAAb;AAAuC,GAPvD,EAQPe,IARO,CAQF,MARE,EAQM,UAASmB,CAAT,EAAY;AAAC,WAAOiB,UAAU,CAACjB,CAAC,CAACM,KAAH,CAAjB;AAA2B,GAR9C,EASPzB,IATO,CASF,OATE,EASO,UAASmB,CAAT,EAAY;AAAC,WAAOA,CAAC,CAACM,KAAT;AAAe,GATnC,EAUPmB,EAVO,CAUJ,WAVI,EAUS1B,SAVT,EAWP0B,EAXO,CAWJ,WAXI,EAWSxB,SAXT,EAYPwB,EAZO,CAYJ,YAZI,EAYUd,UAZV,EAaPc,EAbO,CAaJ,OAbI,EAaKhB,UAbL,CAAZ;AAgBA/C,WAAS,CAACgE,MAAV,CAAiBvD,EAAjB,EAAqBC,KAArB;AACH,CA9GD;;AAgHAV,SAAS,CAACiE,YAAV,GAAyB,UAAS3B,CAAT,EAAY;AACjCtC,WAAS,CAACkE,OAAV,CAAkB5B,CAAlB;AACA6B,SAAO,CAACC,GAAR,CAAY,SAAZ;AACH,CAHD;;AAKApE,SAAS,CAACgE,MAAV,GAAmB,UAASvD,EAAT,EAAa,CAC5B;AACA;AACA;AACH,CAJD;;AAMAT,SAAS,CAACqE,OAAV,GAAoB,UAAS5D,EAAT,EAAa,CAC7B;AACA;AACH,CAHD;;AAKeT,wEAAf,E","file":"dcbfd87-main-wps-hmr.js","sourcesContent":["// d3Heatmap.js\nimport * as d3 from 'd3'\nimport * as fc from 'd3fc'\n\nvar d3Heatmap = {}\n\nconst calculateSizes = (a) => {\n    var cellSize = {}\n    cellSize[a[0]] = {\n        left:  0,\n        right: 0.5*(a[1]-a[0])\n    }\n    for (let i = 1; i<a.length-1; i++) {\n        cellSize[a[i]] = {\n            left:  0.5*(a[i]-a[i-1]),\n            right: 0.5*(a[i+1]-a[i])\n        }\n    }\n    cellSize[a[a.length-1]] = {\n        left:  0.5*(a[a.length-1]-a[a.length-2]),\n        right: 0,\n    }\n    return cellSize;\n}\n\nd3Heatmap.create = (el, props) => {\n    var margin = {top: 30, right: 30, bottom: 50, left: 50},\n        width = 600 - margin.left - margin.right,\n        height = 450 - margin.top - margin.bottom;\n\n    var svg = d3.select(el).append('svg')\n        .attr('width', width + margin.left + margin.right)\n        .attr('height', height + margin.top + margin.bottom)\n        .append('g')\n        .attr('transform',\n            'translate(' + margin.left + ',' + margin.top + ')');\n\n    // Draw axes\n    var cols = props.data.columns.sort(d3.ascending)\n    var rows = props.data.rows.sort(d3.ascending)\n    var scaleX = d3.scaleLinear()\n        .domain([cols[0], cols[cols.length-1]])\n        .range([0, width])\n    var axX = svg.append('g')\n        .attr('transform', 'translate(0,' + height + ')')\n        .call(d3.axisBottom(scaleX));\n    if(props.xLabel) {\n        axX.append('text')\n            .attr('x', 0.5*width)\n            .attr('y', 0.8*margin.bottom)\n            .attr(\"text-anchor\", \"middle\")\n            .attr(\"stroke\", \"black\")\n            .text(props.xLabel);\n    }\n    var scaleY = d3.scaleLinear()\n        .domain([rows[0], rows[rows.length-1]])\n        .range([height, 0])\n    var axY = svg.append('g').call(d3.axisLeft(scaleY));\n    if(props.yLabel) {\n        axY.append('text')\n            .attr(\"transform\", \"rotate(-90)\")\n            .attr('x', -0.5*height)\n            .attr('y', -0.8*margin.bottom)\n            .attr(\"text-anchor\", \"middle\")\n            .attr(\"stroke\", \"black\")\n            .text(props.yLabel);\n    }\n\n        // Add tooltip\n    var tooltip = d3.select(el)\n        .append('div')\n        .style(\"opacity\", 0)\n        .attr(\"class\", \"tooltip\")\n        .style(\"background-color\", \"white\")\n        .style(\"border\", \"solid\")\n        .style(\"border-width\", \"2px\")\n        .style(\"border-radius\", \"5px\")\n        .style(\"padding\", \"5px\")\n        .style(\"position\", \"absolute\")\n    // Three function that change the tooltip when user hover / move / leave a cell\n    var mouseover = function(d) {\n        tooltip.style(\"opacity\", 1)\n    }\n    var mousemove = function(d, object) {\n        tooltip\n            .html(object.x+\",\"+object.y+\"<br>Value: \" + object.value)\n            .style(\"left\", (d.pageX+10) + \"px\")\n            .style(\"top\", (d.pageY+10) + \"px\");\n    }\n    var mouseclick = function(d) {\n        d3.select(d.target)\n            .style(\"stroke\", \"red\")\n    }\n    var mouseleave = function(d) {\n        tooltip.style(\"opacity\", 0)\n        //d3.select(d.target)\n        //    .style(\"stroke\", \"none\")\n    }\n\n    var min = props.data.values[0].value\n    var max = props.data.values[0].value\n    props.data.values.forEach(e => {if(e.value < min) {\n        min = e.value\n    }\n    if(e.value > max) {\n        max = e.value\n    }})\n\n    // Add color scale\n    var colorScale = d3.scaleLinear(d3.interpolateViridis)\n        .domain([min, max])\n        .range([\"#FFFFFF\", \"#000000\"]);\n\n    // draw cells\n    var cellSizeX = calculateSizes(cols);\n    var cellSizeY = calculateSizes(rows);\n    var unitSizeX = width/(cols[cols.length-1]-cols[0])\n    var unitSizeY = height/(rows[rows.length-1]-rows[0])\n    var cells = svg.selectAll('rect')\n        .data(props.data.values)\n        .enter().append('g').append('rect')\n        .attr('class', 'cell')\n        .attr('width', function(d) {return unitSizeX*(cellSizeX[d.x].left + cellSizeX[d.x].right)})\n        .attr('height', function(d) {return unitSizeY*(cellSizeY[d.y].left + cellSizeY[d.y].right)})\n        .attr('y', function(d) {return scaleY(d.y+cellSizeY[d.y].right)})\n        .attr('x', function(d) {return scaleX(d.x-cellSizeX[d.x].left)})\n        .attr('fill', function(d) {return colorScale(d.value)})\n        .attr('value', function(d) {return d.value})\n        .on(\"mouseover\", mouseover)\n        .on(\"mousemove\", mousemove)\n        .on(\"mouseleave\", mouseleave)\n        .on(\"click\", mouseclick)\n\n\n    d3Heatmap.update(el, props);\n};\n\nd3Heatmap.wrappedClick = function(d) {\n    d3Heatmap.onClick(d);\n    console.log(\"Clicked\")\n};\n\nd3Heatmap.update = function(el) {\n    // Recompute the scales and render the data points\n    //var scales = this._scales(el, state.domain);\n    //this._drawPoints(el, scales, state.data);\n};\n\nd3Heatmap.destroy = function(el) {\n    // Any clean up would go here\n    // in this example there is nothing to do\n};\n\nexport default d3Heatmap;\n"],"sourceRoot":""}