{"version":3,"sources":["webpack:///./src/lib/components/d3BrushableHeatmap.js"],"names":["HeatmapD3","el","props","self","update","bind","wrappedClick","margin","top","right","bottom","left","width","height","svg","d3","append","attr","isBrushed","brush_coords","cx","cy","w","h","x0","x1","y0","y1","bottomLeftX","Math","max","bottomLeftY","topRightX","min","topRightY","updateBrush","event","extent","selection","console","log","sourceEvent","shiftKey","coordinates","x","y","newId","cells","d","unitSizeX","cellSizeX","unitSizeY","cellSizeY","scaleX","scaleY","setProps","selectedId","id","value","showPoints","points","style","push","cols","data","columns","sort","rows","domain","length","range","axX","fontSize","call","xLabel","text","axY","yLabel","tooltip","mouseover","mousemove","object","html","pageX","pageY","mouseleave","minValue","values","maxValue","forEach","e","colorScale","legendProps","title","valueLabel","tickSize","marginTop","marginRight","marginBottom","marginLeft","ticks","ramp","color","n","canvas","document","createElement","context","getContext","i","fillStyle","fillRect","copy","rangeRound","toDataURL","legendTitle","g","select","remove","brush","on","calculateSizes","selectAll","enter","a","cellSize"],"mappings":"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","file":"da16b3c-main-wps-hmr.js","sourcesContent":["// d3Heatmap.js\nimport * as d3 from 'd3'\n\nexport default class HeatmapD3 {\n    constructor(el, props) {\n        const self = this;\n        self.update = self.update.bind(self);\n        self.wrappedClick = self.wrappedClick.bind(self);\n        self.props = props\n\n        var margin = {top: 30, right: 100, bottom: 50, left: 50},\n            width = props.width - margin.left - margin.right,\n            height = props.height - margin.top - margin.bottom;\n\n        this.width = width;\n        this.height = height;\n\n        self.svg = d3.select(el).append('svg')\n            .attr('width', width + margin.left + margin.right)\n            .attr('height', height + margin.top + margin.bottom)\n            .append('g')\n            .attr('transform',\n                'translate(' + margin.left + ',' + margin.top + ')');\n\n        // Add brushing\n        var isBrushed = (brush_coords, cx, cy, w, h) => {\n            var x0 = brush_coords[0][0],\n                x1 = brush_coords[1][0],\n                y0 = brush_coords[0][1],\n                y1 = brush_coords[1][1]\n            // selects if there is an intersection\n            var bottomLeftX = Math.max(cx, x0),\n                bottomLeftY = Math.max(cy, y0),\n                topRightX = Math.min(cx + w, x1),\n                topRightY = Math.min(cy + h, y1);\n            return (bottomLeftX <= topRightX && bottomLeftY <= topRightY);\n        };\n\n        var updateBrush = (event) => {\n            var extent = event.selection;\n            console.log(event);\n            if(event.sourceEvent.shiftKey) {\n                var coordinates = d3.pointer(this);\n                console.log(coordinates);\n                extent = [[event.sourceEvent.x, event.sourceEvent.y], [event.sourceEvent.x, event.sourceEvent.y]];\n                var newId = 0;\n                this.cells.attr(\"value\", function (d) {\n                        var w = unitSizeX * (cellSizeX[d.x].left + cellSizeX[d.x].right);\n                        var h = unitSizeY * (cellSizeY[d.y].left + cellSizeY[d.y].right);\n                        if (isBrushed(extent, scaleX(d.x - cellSizeX[d.x].left), scaleY(d.y + cellSizeY[d.y].right), w, h)) {\n                            props.setProps({selectedId: d.id});\n                            newId = d.id;\n                            return d.value;\n                        } else {\n                            return d.value;\n                        }\n                    })\n                if(this.props.showPoints) {\n                    this.points.style('fill', function(d) {\n                        if(d.id === newId) {\n                            console.log(\"Selected\")\n                            return \"red\";\n                        }\n                        else {\n                            return \"black\";\n                        }\n                    })\n                }\n            }\n            else {\n                if (extent) {\n                    var selection = []\n                    this.cells.style(\"opacity\", function (d) {\n                        var w = unitSizeX * (cellSizeX[d.x].left + cellSizeX[d.x].right);\n                        var h = unitSizeY * (cellSizeY[d.y].left + cellSizeY[d.y].right);\n                        if (isBrushed(extent, scaleX(d.x - cellSizeX[d.x].left), scaleY(d.y + cellSizeY[d.y].right), w, h)) {\n                            selection.push(d.id)\n                            return 1;\n                        } else {\n                            return 0.5;\n                        }\n                    })\n                    props.setProps({selection: selection});\n                } else {\n                    console.log(\"Null\")\n                    this.cells.style(\"opacity\", 1)\n                }\n            }\n        }\n\n        // Draw axes\n        var cols = props.data.columns.sort(d3.ascending)\n        var rows = props.data.rows.sort(d3.ascending)\n        var scaleX = d3.scaleLinear()\n            .domain([cols[0], cols[cols.length - 1]])\n            .range([0, width])\n        self.axX = self.svg.append('g')\n            .style(\"font\", props.fontSize + \"px times\")\n            .attr('transform', 'translate(0,' + height + ')')\n            .call(d3.axisBottom(scaleX));\n        self.xLabel = self.axX.append('text')\n            .attr('x', 0.5 * width)\n            .attr('y', 0.8 * margin.bottom)\n            .attr(\"text-anchor\", \"middle\")\n            .attr(\"fill\", \"black\")\n            .attr(\"font-size\", props.fontSize)\n            .text(props.xLabel);\n        var scaleY = d3.scaleLinear()\n            .domain([rows[0], rows[rows.length - 1]])\n            .range([height, 0])\n        self.axY = self.svg.append('g')\n            .style(\"font\", props.fontSize + \"px times\")\n            .call(d3.axisLeft(scaleY));\n        self.yLabel = self.axY.append('text')\n            .attr(\"transform\", \"rotate(-90)\")\n            .attr('x', -0.5 * height)\n            .attr('y', -0.8 * margin.bottom)\n            .attr(\"text-anchor\", \"middle\")\n            .attr(\"fill\", \"black\")\n            .attr(\"font-size\", props.fontSize)\n            .text(props.yLabel);\n\n        // Add tooltip\n        var tooltip = this.svg\n            .append('div')\n            .style(\"opacity\", 0)\n            .attr(\"class\", \"tooltip\")\n            .style(\"background-color\", \"white\")\n            .style(\"border\", \"solid\")\n            .style(\"border-width\", \"2px\")\n            .style(\"border-radius\", \"5px\")\n            .style(\"padding\", \"5px\")\n            .style(\"position\", \"absolute\")\n        // Three function that change the tooltip when user hover / move / leave a cell\n        var mouseover = function (d) {\n            tooltip.style(\"opacity\", 1);\n        }\n        var mousemove = function (d, object) {\n            tooltip\n                .html(object.x + \",\" + object.y + \"<br>Value: \" + object.value)\n                .style(\"left\", (d.pageX + 10) + \"px\")\n                .style(\"top\", (d.pageY + 10) + \"px\");\n        }\n        var mouseleave = function (d) {\n            tooltip.style(\"opacity\", 0);\n        }\n\n        var minValue = props.data.values[0].value\n        var maxValue = props.data.values[0].value\n        props.data.values.forEach(e => {\n            if (e.value < minValue) {\n                minValue = e.value\n            }\n            if (e.value > maxValue) {\n                maxValue = e.value\n            }\n        })\n\n        // Add color scale\n        var colorScale = d3.scaleSequential(d3.interpolateViridis)\n            .domain([maxValue, minValue])\n\n        // Color bar\n        const legendProps = {\n            title: props.valueLabel,\n            tickSize: 6,\n            width: 30,\n            height: props.height - margin.top - margin.bottom,// + tickSize,\n            marginTop: 0,\n            marginRight: 0,\n            marginBottom: 0,// + tickSize,\n            marginLeft: 10,\n            ticks: width / 64\n        };\n\n\n\n        function ramp(color, n = 256) {\n            const canvas = document.createElement(\"canvas\");\n            canvas.width = 1;\n            canvas.height = n;\n            const context = canvas.getContext(\"2d\");\n            for (let i = 0; i < n; ++i) {\n                context.fillStyle = color(i / (n - 1));\n                context.fillRect(0, n - 1 - i, 1, 1);\n            }\n            return canvas;\n        }\n\n        const n = Math.min(colorScale.domain().length, colorScale.range().length)\n        let x = colorScale.copy().rangeRound(d3.quantize(d3.interpolate(legendProps.marginTop, legendProps.height - legendProps.marginBottom), n));\n        self.svg.append(\"image\")\n            .attr(\"x\", width + legendProps.marginLeft)\n            .attr(\"y\", legendProps.marginTop)\n            .attr(\"width\", legendProps.width - legendProps.marginLeft - legendProps.marginRight)\n            .attr(\"height\", legendProps.height - legendProps.marginTop - legendProps.marginBottom)\n            .attr(\"preserveAspectRatio\", \"none\")\n            .attr(\"xlink:href\", ramp(colorScale.copy().domain(d3.quantize(d3.interpolate(0, 1), n))).toDataURL());\n        self.legendTitle = self.svg.append(\"g\")\n            .style(\"font\", props.fontSize + \"px times\")\n            .attr(\"transform\", 'translate(' + (width + legendProps.width) + ',0)')\n            .call(d3.axisRight(x))\n            .call(g => g.select(\".domain\").remove())\n            .append(\"text\")\n            .attr(\"x\", -legendProps.width + legendProps.marginLeft)\n            .attr(\"y\", -5)\n            .attr(\"fill\", \"black\")\n            .attr(\"text-anchor\", \"start\")\n            .attr(\"font-size\", props.fontSize)\n            .text(legendProps.title);\n\n        colorScale = d3.scaleSequential(d3.interpolateViridis)\n            .domain([minValue, maxValue])\n\n        var brush = d3.brush()\n               .extent([[0, 0], [this.width, this.height]])\n               .on(\"end\", updateBrush);\n        this.svg.append(\"g\")\n            .attr(\"class\", \"brush\")\n            .call(brush)\n\n        // draw cells\n        var cellSizeX = calculateSizes(cols);\n        var cellSizeY = calculateSizes(rows);\n        console.log(cellSizeX)\n        var unitSizeX = width / (cols[cols.length - 1] - cols[0]);\n        var unitSizeY = height / (rows[rows.length - 1] - rows[0]);\n        this.cells = self.svg.selectAll('.rect')\n            .data(props.data.values)\n            .enter().append('g')\n        this.cells.append('rect')\n            .attr('class', 'cell')\n            .attr('width', function (d) {\n                return unitSizeX * (cellSizeX[d.x].left + cellSizeX[d.x].right)\n            })\n            .attr('height', function (d) {\n                return unitSizeY * (cellSizeY[d.y].left + cellSizeY[d.y].right)\n            })\n            .attr('y', function (d) {\n                return scaleY(d.y + cellSizeY[d.y].right)\n            })\n            .attr('x', function (d) {\n                return scaleX(d.x - cellSizeX[d.x].left)\n            })\n            .attr('fill', function (d) {\n                return colorScale(d.value)//\"#FFFFFF10\"//\n            })\n            .attr('value', function (d) {\n                return d.value\n            })\n            .attr('dataID', function (d) {\n                return d.id;\n            })\n            .attr('pointer-events', 'all')\n            .on(\"mouseover\", mouseover)\n            .on(\"mousemove\", mousemove)\n            .on(\"mouseleave\", mouseleave)\n            .on(\"click\", self.wrappedClick)\n        if (props.showPoints) {\n            this.points = this.cells.append(\"circle\")\n                .attr('cx', function (d) {\n                    return scaleX(d.x)\n                })\n                .attr('cy', function (d) {\n                    return scaleY(d.y)\n                })\n                .attr('r', 5)\n                .style('fill', 'black')\n        }\n    }\n\n    wrappedClick(d, object) {\n        console.log(\"Click!\");\n        this.props.setProps({selectedId: object.id});\n    }\n\n    update(props) {\n        this.legendTitle\n            .text(props.valueLabel);\n    }\n}\n\nconst calculateSizes = (a) => {\n    var cellSize = {}\n    cellSize[a[0]] = {\n        left: 0,\n        right: 0.5 * (a[1] - a[0])\n    }\n    for (let i = 1; i < a.length - 1; i++) {\n        cellSize[a[i]] = {\n            left: 0.5 * (a[i] - a[i - 1]),\n            right: 0.5 * (a[i + 1] - a[i])\n        }\n    }\n    cellSize[a[a.length - 1]] = {\n        left: 0.5 * (a[a.length - 1] - a[a.length - 2]),\n        right: 0,\n    }\n    return cellSize;\n}\n"],"sourceRoot":""}