{"version":3,"sources":["webpack:///./src/lib/components/d3BrushableHeatmap.js"],"names":["d3Heatmap","calculateSizes","a","cellSize","left","right","i","length","create","el","props","margin","top","bottom","width","height","svg","d3","append","attr","cols","data","columns","sort","rows","scaleX","domain","range","axX","call","xLabel","text","scaleY","axY","yLabel","tooltip","style","mouseover","d","mousemove","object","html","x","y","value","pageX","pageY","mouseclick","target","mouseleave","minValue","values","maxValue","forEach","e","colorScale","legendProps","title","valueLabel","tickSize","marginTop","marginRight","marginBottom","marginLeft","ticks","ramp","color","n","canvas","document","createElement","context","getContext","fillStyle","fillRect","Math","min","copy","rangeRound","toDataURL","g","select","remove","cellSizeX","cellSizeY","unitSizeX","unitSizeY","cells","selectAll","enter","on","update","wrappedClick","onClick","console","log","destroy"],"mappings":"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","file":"6c1b1f5-main-wps-hmr.js","sourcesContent":["// d3Heatmap.js\nimport * as d3 from 'd3'\nimport * as fc from 'd3fc'\n\nvar d3Heatmap = {}\n\nconst calculateSizes = (a) => {\n    var cellSize = {}\n    cellSize[a[0]] = {\n        left: 0,\n        right: 0.5 * (a[1] - a[0])\n    }\n    for (let i = 1; i < a.length - 1; i++) {\n        cellSize[a[i]] = {\n            left: 0.5 * (a[i] - a[i - 1]),\n            right: 0.5 * (a[i + 1] - a[i])\n        }\n    }\n    cellSize[a[a.length - 1]] = {\n        left: 0.5 * (a[a.length - 1] - a[a.length - 2]),\n        right: 0,\n    }\n    return cellSize;\n}\n\nd3Heatmap.create = (el, props) => {\n    var margin = {top: 30, right: 100, bottom: 50, left: 50},\n        width = props.width - margin.left - margin.right,\n        height = props.height - margin.top - margin.bottom;\n\n    var svg = d3.select(el).append('svg')\n        .attr('width', width + margin.left + margin.right)\n        .attr('height', height + margin.top + margin.bottom)\n        .append('g')\n        .attr('transform',\n            'translate(' + margin.left + ',' + margin.top + ')');\n\n    // Draw axes\n    var cols = props.data.columns.sort(d3.ascending)\n    var rows = props.data.rows.sort(d3.ascending)\n    var scaleX = d3.scaleLinear()\n        .domain([cols[0], cols[cols.length - 1]])\n        .range([0, width])\n    var axX = svg.append('g')\n        .attr('transform', 'translate(0,' + height + ')')\n        .call(d3.axisBottom(scaleX));\n    if (props.xLabel) {\n        axX.append('text')\n            .attr('x', 0.5 * width)\n            .attr('y', 0.8 * margin.bottom)\n            .attr(\"text-anchor\", \"middle\")\n            .attr(\"fill\", \"black\")\n            .text(props.xLabel);\n    }\n    var scaleY = d3.scaleLinear()\n        .domain([rows[0], rows[rows.length - 1]])\n        .range([height, 0])\n    var axY = svg.append('g').call(d3.axisLeft(scaleY));\n    if (props.yLabel) {\n        axY.append('text')\n            .attr(\"transform\", \"rotate(-90)\")\n            .attr('x', -0.5 * height)\n            .attr('y', -0.8 * margin.bottom)\n            .attr(\"text-anchor\", \"middle\")\n            .attr(\"fill\", \"black\")\n            .text(props.yLabel);\n    }\n\n    // Add tooltip\n    var tooltip = d3.select(el)\n        .append('div')\n        .style(\"opacity\", 0)\n        .attr(\"class\", \"tooltip\")\n        .style(\"background-color\", \"white\")\n        .style(\"border\", \"solid\")\n        .style(\"border-width\", \"2px\")\n        .style(\"border-radius\", \"5px\")\n        .style(\"padding\", \"5px\")\n        .style(\"position\", \"absolute\")\n    // Three function that change the tooltip when user hover / move / leave a cell\n    var mouseover = function (d) {\n        tooltip.style(\"opacity\", 1)\n    }\n    var mousemove = function (d, object) {\n        tooltip\n            .html(object.x + \",\" + object.y + \"<br>Value: \" + object.value)\n            .style(\"left\", (d.pageX + 10) + \"px\")\n            .style(\"top\", (d.pageY + 10) + \"px\");\n    }\n    var mouseclick = function (d) {\n        d3.select(d.target)\n            .style(\"stroke\", \"red\")\n    }\n    var mouseleave = function (d) {\n        tooltip.style(\"opacity\", 0)\n        //d3.select(d.target)\n        //    .style(\"stroke\", \"none\")\n    }\n\n    var minValue = props.data.values[0].value\n    var maxValue = props.data.values[0].value\n    props.data.values.forEach(e => {\n        if (e.value < minValue) {\n            minValue = e.value\n        }\n        if (e.value > maxValue) {\n            maxValue = e.value\n        }\n    })\n\n    // Add color scale\n    var colorScale = d3.scaleSequential(d3.interpolateViridis)\n        .domain([maxValue, minValue])\n\n    // Second attempt for color bar\n    const legendProps = {\n        title: props.valueLabel,\n        tickSize: 6,\n        width: 30,\n        height: props.height - margin.top - margin.bottom,// + tickSize,\n        marginTop: 0,\n        marginRight: 0,\n        marginBottom: 0,// + tickSize,\n        marginLeft: 10,\n        ticks: width / 64\n    };\n\n    function ramp(color, n = 256) {\n        const canvas = document.createElement(\"canvas\");\n        canvas.width = 1;\n        canvas.height = n;\n        const context = canvas.getContext(\"2d\");\n        for (let i = 0; i < n; ++i) {\n            context.fillStyle = color(i / (n - 1));\n            context.fillRect(0, n-1-i, 1, 1);\n        }\n        return canvas;\n    }\n\n    const n = Math.min(colorScale.domain().length, colorScale.range().length)\n    let x = colorScale.copy().rangeRound(d3.quantize(d3.interpolate(legendProps.marginTop, legendProps.height - legendProps.marginBottom), n));\n    svg.append(\"image\")\n        .attr(\"x\", width + legendProps.marginLeft)\n        .attr(\"y\", legendProps.marginTop)\n        .attr(\"width\", legendProps.width - legendProps.marginLeft - legendProps.marginRight)\n        .attr(\"height\", legendProps.height - legendProps.marginTop - legendProps.marginBottom)\n        .attr(\"preserveAspectRatio\", \"none\")\n        .attr(\"xlink:href\", ramp(colorScale.copy().domain(d3.quantize(d3.interpolate(0, 1), n))).toDataURL());\n    svg.append(\"g\")\n      .attr(\"transform\", 'translate('+(width+legendProps.width)+',0)')\n      .call(d3.axisRight(x))\n        //.ticks(colorScale.ticks)//, typeof colorScale.tickFormat === \"string\" ? colorScale.tickFormat : undefined)\n        //.tickFormat(typeof colorScale.tickFormat === \"function\" ? colorScale.tickFormat : undefined)\n        //.tickSize(colorScale.tickSize))\n        //.tickValues(colorScale.tickValues))\n      //.call(colorScale.tickAdjust)\n      .call(g => g.select(\".domain\").remove())\n      .append(\"text\")\n        //.attr(\"transform\", \"rotate(-90)\")\n        .attr(\"x\", -legendProps.width+legendProps.marginLeft)\n        .attr(\"y\", -5)\n        .attr(\"fill\", \"black\")\n        .attr(\"text-anchor\", \"start\")\n        //.attr(\"font-weight\", \"bold\")\n        .text(legendProps.title);\n\n    colorScale = d3.scaleSequential(d3.interpolateViridis)\n        .domain([minValue, maxValue])\n\n    // draw cells\n    var cellSizeX = calculateSizes(cols);\n    var cellSizeY = calculateSizes(rows);\n    var unitSizeX = width / (cols[cols.length - 1] - cols[0]);\n    var unitSizeY = height / (rows[rows.length - 1] - rows[0]);\n    var cells = svg.selectAll('rect')\n        .data(props.data.values)\n        .enter().append('g').append('rect')\n        .attr('class', 'cell')\n        .attr('width', function (d) {\n            return unitSizeX * (cellSizeX[d.x].left + cellSizeX[d.x].right)\n        })\n        .attr('height', function (d) {\n            return unitSizeY * (cellSizeY[d.y].left + cellSizeY[d.y].right)\n        })\n        .attr('y', function (d) {\n            return scaleY(d.y + cellSizeY[d.y].right)\n        })\n        .attr('x', function (d) {\n            return scaleX(d.x - cellSizeX[d.x].left)\n        })\n        .attr('fill', function (d) {\n            return colorScale(d.value)//\"#FFFFFF00\"//\n        })\n        .attr('value', function (d) {\n            return d.value\n        })\n        .on(\"mouseover\", mouseover)\n        .on(\"mousemove\", mousemove)\n        .on(\"mouseleave\", mouseleave)\n        .on(\"click\", mouseclick)\n\n\n    d3Heatmap.update(el, props);\n};\n\nd3Heatmap.wrappedClick = function (d) {\n    d3Heatmap.onClick(d);\n    console.log(\"Clicked\")\n};\n\nd3Heatmap.update = function (el) {\n    // Recompute the scales and render the data points\n    //var scales = this._scales(el, state.domain);\n    //this._drawPoints(el, scales, state.data);\n};\n\nd3Heatmap.destroy = function (el) {\n    // Any clean up would go here\n    // in this example there is nothing to do\n};\n\nexport default d3Heatmap;\n"],"sourceRoot":""}